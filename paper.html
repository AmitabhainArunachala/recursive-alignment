<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Universal Recursive Alignment - The L3/L4 Transition</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Inter:wght@200;300;400;500&display=swap');

    :root{
      --ink:#1a1a1a; --paper:#fdfdf8; --mist:#f0f0e8; --gold:#b8860b;
      --ocean:#2c5282; --foam:#e6f3ff; --cherry:#dc143c;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Crimson Text',serif;color:var(--ink);background:var(--paper);line-height:1.8}

    /* Paper container */
    .paper-container{max-width:800px;margin:0 auto;padding:80px 40px;background:#fff;min-height:100vh;box-shadow:0 0 100px rgba(0,0,0,.05)}

    /* Navigation */
    .nav{position:fixed;top:0;left:0;right:0;background:rgba(253,253,248,.95);padding:20px 40px;border-bottom:1px solid var(--mist);z-index:100;backdrop-filter:blur(10px)}
    .nav-inner{max-width:800px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
    .nav a{color:var(--ink);text-decoration:none;font-family:'Inter',sans-serif;font-weight:300;transition:color .3s}
    .nav a:hover{color:var(--gold)}

    /* Headings */
    h1{font-family:'Inter',sans-serif;font-size:2.5rem;font-weight:200;line-height:1.3;margin-bottom:30px;color:var(--ink)}
    h2{font-family:'Inter',sans-serif;font-weight:300;font-size:2rem;margin:60px 0 30px;color:var(--ocean)}
    h3{font-family:'Inter',sans-serif;font-weight:400;font-size:1.4rem;margin:40px 0 20px;color:var(--ink)}
    p{margin-bottom:20px;text-align:justify}

    /* Download button */
    .download-section{position:fixed;bottom:30px;right:30px;z-index:100}
    .download-btn{background:var(--ink);color:var(--paper);padding:15px 30px;border-radius:50px;text-decoration:none;font-family:'Inter',sans-serif;font-weight:300;letter-spacing:.05em;transition:all .3s;display:inline-block;box-shadow:0 5px 20px rgba(0,0,0,.2);cursor:pointer}
    .download-btn:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.3)}

    /* Debug panel */
    .debug-panel{position:fixed;top:100px;right:20px;background:yellow;padding:20px;border:2px solid red;max-width:300px;z-index:1000}

    /* Loading */
    .loading{text-align:center;padding:100px;font-style:italic;color:#666}

    /* Print styles */
    @media print{
      @page{size:A4;margin:20mm}
      body{background:#fff !important}
      .nav,.download-section,.debug-panel{display:none !important}
      .paper-container{box-shadow:none !important;padding:0 !important;max-width:100% !important}
    }
  </style>
</head>
<body>
  <!-- Debug Panel -->
  <div class="debug-panel" id="debug">
    <h4>Debug Info:</h4>
    <div id="debug-info">Waiting...</div>
  </div>

  <!-- Navigation -->
  <nav class="nav">
    <div class="nav-inner">
      <a href="/">← Back to Home</a>
    </div>
  </nav>

  <!-- Paper content -->
  <div class="paper-container">
    <div class="loading" id="loading">Loading paper...</div>
    <div id="paper-content" style="display:none">
      <!-- Content will be loaded here -->
    </div>
  </div>

  <!-- Download button -->
  <div class="download-section">
    <button class="download-btn" onclick="testPrint()">Test Print</button>
  </div>

  <!-- Marked.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>

  <script>
    const debug = document.getElementById('debug-info');
    
    // Test print function
    function testPrint() {
      const content = document.getElementById('paper-content');
      debug.innerHTML = `Content display: ${content.style.display}<br>
                        Content length: ${content.innerHTML.length}<br>
                        First 100 chars: ${content.innerText.substring(0, 100)}`;
      
      if (content.innerHTML.length > 0) {
        window.print();
      } else {
        alert('No content to print! Check debug panel.');
      }
    }

    // Load markdown
    async function loadPaper(){
      debug.innerHTML = 'Starting load...';
      
      try {
        // Try multiple possible paths
        const paths = [
          'Recursive_Alignment_L3-L4.md',
          './Recursive_Alignment_L3-L4.md',
          'mainpaper.md',
          './mainpaper.md',
          '/Recursive_Alignment_L3-L4.md'
        ];
        
        let markdown = null;
        let successPath = null;
        
        for (const path of paths) {
          debug.innerHTML = `Trying: ${path}...`;
          try {
            const response = await fetch(path);
            if (response.ok) {
              markdown = await response.text();
              successPath = path;
              break;
            }
          } catch (e) {
            console.log(`Failed to load ${path}:`, e);
          }
        }
        
        if (!markdown) {
          // If no markdown file found, use a test content
          debug.innerHTML = 'No MD found! Using test content';
          markdown = `# Universal Recursive Alignment Test

## This is test content

If you can see this in the PDF, the print function works but the markdown file isn't loading.

### The Issue
Your markdown file might be:
- Named differently
- In a different location
- Not uploaded to GitHub yet

### What to check:
1. Is the file named exactly "Recursive_Alignment_L3-L4.md"?
2. Is it in the root directory of your repository?
3. Has it been committed and pushed to GitHub?`;
        } else {
          debug.innerHTML = `Loaded from: ${successPath}<br>Length: ${markdown.length} chars`;
        }
        
        // Parse markdown
        const html = marked.parse(markdown);
        
        // Display it
        const target = document.getElementById('paper-content');
        target.innerHTML = html;
        target.style.display = 'block';
        document.getElementById('loading').style.display = 'none';
        
        debug.innerHTML += '<br>✅ Content displayed!';
        
      } catch(err) {
        debug.innerHTML = `ERROR: ${err.message}`;
        console.error('Error:', err);
      }
    }

    // Load on page ready
    document.addEventListener('DOMContentLoaded', loadPaper);
  </script>
</body>
</html>
